============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.3.4, pluggy-1.6.0 -- C:\Users\lenovo\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\python.exe
cachedir: .pytest_cache
metadata: {'Python': '3.11.9', 'Platform': 'Windows-10-10.0.26200-SP0', 'Packages': {'pytest': '8.3.4', 'pluggy': '1.6.0'}, 'Plugins': {'allure-pytest': '2.13.5', 'anyio': '4.12.1', 'bdd': '8.1.0', 'html': '4.1.1', 'metadata': '3.1.1', 'xdist': '3.6.1'}, 'JAVA_HOME': 'C:\\Program Files\\Java\\jdk-25'}
rootdir: D:\HistoryMindAI\vietnam_history_dataset
plugins: allure-pytest-2.13.5, anyio-4.12.1, bdd-8.1.0, html-4.1.1, metadata-3.1.1, xdist-3.6.1
collecting ... collected 899 items

tests/test_advanced_resilience.py::TestCat1Determinism::test_28_deterministic_output PASSED [  0%]
tests/test_advanced_resilience.py::TestCat1Determinism::test_29_deterministic_fact_check PASSED [  0%]
tests/test_advanced_resilience.py::TestCat1Determinism::test_30_retrieval_order_stable PASSED [  0%]
tests/test_advanced_resilience.py::TestCat1Determinism::test_31_answer_hash_stable PASSED [  0%]
tests/test_advanced_resilience.py::TestCat2RetrievalIntegrity::test_32_no_cross_entity_leak PASSED [  0%]
tests/test_advanced_resilience.py::TestCat2RetrievalIntegrity::test_33_year_scan_precision PASSED [  0%]
tests/test_advanced_resilience.py::TestCat2RetrievalIntegrity::test_34_scan_nonexistent_entity PASSED [  0%]
tests/test_advanced_resilience.py::TestCat2RetrievalIntegrity::test_35_dynasty_index_isolation PASSED [  0%]
tests/test_advanced_resilience.py::TestCat3GuardrailCorrection::test_36_truncation_auto_fix PASSED [  1%]
tests/test_advanced_resilience.py::TestCat3GuardrailCorrection::test_37_completeness_auto_fix PASSED [  1%]
tests/test_advanced_resilience.py::TestCat3GuardrailCorrection::test_38_empty_answer_hard_fail PASSED [  1%]
tests/test_advanced_resilience.py::TestCat3GuardrailCorrection::test_39_severity_escalation PASSED [  1%]
tests/test_advanced_resilience.py::TestCat3GuardrailCorrection::test_40_guardrail_idempotency PASSED [  1%]
tests/test_advanced_resilience.py::TestCat4FAISSIntegrity::test_41_meta_count_matches_index PASSED [  1%]
tests/test_advanced_resilience.py::TestCat4FAISSIntegrity::test_42_meta_dimension_matches_index PASSED [  1%]
tests/test_advanced_resilience.py::TestCat4FAISSIntegrity::test_43_meta_schema_valid PASSED [  1%]
tests/test_advanced_resilience.py::TestCat5VersionFreeze::test_44_entity_metadata_core_coverage PASSED [  1%]
tests/test_advanced_resilience.py::TestCat5VersionFreeze::test_45_alias_coverage_complete PASSED [  2%]
tests/test_advanced_resilience.py::TestCat5VersionFreeze::test_46_topic_synonyms_self_map PASSED [  2%]
tests/test_advanced_resilience.py::TestCat5VersionFreeze::test_47_missing_entity_graceful PASSED [  2%]
tests/test_advanced_resilience.py::TestCat6ChaoCorruption::test_48_empty_documents_graceful PASSED [  2%]
tests/test_advanced_resilience.py::TestCat6ChaoCorruption::test_49_single_document_only PASSED [  2%]
tests/test_advanced_resilience.py::TestCat6ChaoCorruption::test_50_corrupt_year_field PASSED [  2%]
tests/test_advanced_resilience.py::TestCat6ChaoCorruption::test_51_duplicate_document_flood PASSED [  2%]
tests/test_advanced_resilience.py::TestCat6ChaoCorruption::test_52_missing_story_field PASSED [  2%]
tests/test_advanced_resilience.py::TestCat7ConcurrencySafety::test_53_concurrent_engine_calls PASSED [  2%]
tests/test_advanced_resilience.py::TestCat7ConcurrencySafety::test_54_concurrent_mixed_intents PASSED [  3%]
tests/test_advanced_resilience.py::TestCat8PerformanceGuard::test_55_response_time_under_threshold PASSED [  3%]
tests/test_advanced_resilience.py::TestCat8PerformanceGuard::test_56_batch_queries_throughput PASSED [  3%]
tests/test_advanced_resilience.py::TestCat9DataTypeCorruption::test_57_year_none_no_crash PASSED [  3%]
tests/test_advanced_resilience.py::TestCat9DataTypeCorruption::test_58_year_empty_string_no_crash PASSED [  3%]
tests/test_advanced_resilience.py::TestCat9DataTypeCorruption::test_59_year_list_no_crash PASSED [  3%]
tests/test_advanced_resilience.py::TestCat9DataTypeCorruption::test_60_year_bool_true_no_crash PASSED [  3%]
tests/test_advanced_resilience.py::TestCat9DataTypeCorruption::test_61_year_bool_false_no_crash PASSED [  3%]
tests/test_answer_synthesis.py::TestDataScope::test_data_scope_with_docs PASSED [  3%]
tests/test_answer_synthesis.py::TestDataScope::test_data_scope_no_docs PASSED [  4%]
tests/test_answer_synthesis.py::TestDataScope::test_data_scope_no_years PASSED [  4%]
tests/test_answer_synthesis.py::TestWhenAnswer::test_when_answer_returns_year PASSED [  4%]
tests/test_answer_synthesis.py::TestWhenAnswer::test_when_answer_no_data_dump PASSED [  4%]
tests/test_answer_synthesis.py::TestWhenAnswer::test_when_answer_empty PASSED [  4%]
tests/test_answer_synthesis.py::TestWhoAnswer::test_who_answer PASSED    [  4%]
tests/test_answer_synthesis.py::TestWhoAnswer::test_who_answer_limits_events PASSED [  4%]
tests/test_answer_synthesis.py::TestWhoAnswer::test_who_answer_deduplicates PASSED [  4%]
tests/test_answer_synthesis.py::TestListAnswer::test_list_answer PASSED  [  4%]
tests/test_answer_synthesis.py::TestListAnswer::test_list_answer_empty PASSED [  5%]
tests/test_answer_synthesis.py::TestListAnswer::test_list_deduplicates PASSED [  5%]
tests/test_answer_synthesis.py::TestWhatAnswer::test_what_answer PASSED  [  5%]
tests/test_answer_synthesis.py::TestWhatAnswer::test_what_answer_limits_to_7 PASSED [  5%]
tests/test_answer_synthesis.py::TestWhatAnswer::test_what_answer_empty PASSED [  5%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_bac_thuoc PASSED [  5%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_tran PASSED     [  5%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_nguyen PASSED   [  5%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_khang_chien_phap PASSED [  5%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_khang_chien_my PASSED [  6%]
tests/test_answer_synthesis.py::TestPeriodGrouping::test_doi_moi PASSED  [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_data_scope_intent PASSED [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_when_intent PASSED [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_who_intent PASSED [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_list_intent PASSED [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_what_intent PASSED [  6%]
tests/test_answer_synthesis.py::TestSynthesizeAnswer::test_no_events PASSED [  6%]
tests/test_api.py::test_health PASSED                                    [  6%]
tests/test_api.py::test_root PASSED                                      [  7%]
tests/test_api.py::test_chat_endpoint_success PASSED                     [  7%]
tests/test_api.py::test_chat_endpoint_no_data PASSED                     [  7%]
tests/test_api.py::test_chat_endpoint_empty_query PASSED                 [  7%]
tests/test_bug_fixes.py::TestBug1EmptyStringCapitalization::test_format_event_with_empty_story PASSED [  7%]
tests/test_bug_fixes.py::TestBug1EmptyStringCapitalization::test_format_event_with_whitespace_only_story PASSED [  7%]
tests/test_bug_fixes.py::TestBug1EmptyStringCapitalization::test_format_event_with_only_metadata PASSED [  7%]
tests/test_bug_fixes.py::TestBug1EmptyStringCapitalization::test_clean_story_text_empty_input PASSED [  7%]
tests/test_bug_fixes.py::TestBug2EmptyListMax::test_handle_data_scope_with_empty_documents PASSED [  7%]
tests/test_bug_fixes.py::TestBug2EmptyListMax::test_handle_data_scope_with_no_year_field PASSED [  8%]
tests/test_bug_fixes.py::TestBug2EmptyListMax::test_build_when_answer_with_events_missing_year PASSED [  8%]
tests/test_bug_fixes.py::TestBug4NullUndefinedInFormatEvent::test_format_event_with_null_story_and_event PASSED [  8%]
tests/test_bug_fixes.py::TestBug4NullUndefinedInFormatEvent::test_format_event_with_missing_fields PASSED [  8%]
tests/test_bug_fixes.py::TestBug4NullUndefinedInFormatEvent::test_format_event_with_null_title PASSED [  8%]
tests/test_bug_fixes.py::TestBug4NullUndefinedInFormatEvent::test_deduplicate_with_null_story_fields PASSED [  8%]
tests/test_bug_fixes.py::TestBug5NegativeFAISSIndices::test_semantic_search_with_negative_indices PASSED [  8%]
tests/test_bug_fixes.py::TestBug5NegativeFAISSIndices::test_semantic_search_with_out_of_bounds_indices PASSED [  8%]
tests/test_bug_fixes.py::TestBug5NegativeFAISSIndices::test_scan_by_entities_with_negative_indices PASSED [  8%]
tests/test_bug_fixes.py::TestBug5AdditionalEdgeCases::test_empty_embedding_query PASSED [  9%]
tests/test_bug_fixes.py::TestBug5AdditionalEdgeCases::test_semantic_search_with_all_negative_scores PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_standard_capitalized_name PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_hai_ba_trung_lowercase_hai PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_hai_ba_trung_capitalized PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_trung_trac_maps_to_hai_ba_trung PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_trung_nhi_maps_to_hai_ba_trung PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_hardcoded_patterns_iterate_all PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_normalize_person_all_aliases PASSED [  9%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_empty_text_returns_empty PASSED [ 10%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_no_persons_in_text PASSED [ 10%]
tests/test_comprehensive.py::TestExtractPersonsDynamic::test_geo_context_no_false_positive PASSED [ 10%]
tests/test_comprehensive.py::TestExtractPlacesDynamic::test_geo_prefix_extraction PASSED [ 10%]
tests/test_comprehensive.py::TestExtractPlacesDynamic::test_empty_text_returns_empty PASSED [ 10%]
tests/test_comprehensive.py::TestExtractDynastyDynamic::test_all_dynasty_patterns_match PASSED [ 10%]
tests/test_comprehensive.py::TestExtractDynastyDynamic::test_nha_tran_detection PASSED [ 10%]
tests/test_comprehensive.py::TestExtractDynastyDynamic::test_year_fallback PASSED [ 10%]
tests/test_comprehensive.py::TestExtractKeywordsDynamic::test_returns_keywords PASSED [ 10%]
tests/test_comprehensive.py::TestExtractKeywordsDynamic::test_empty_text PASSED [ 11%]
tests/test_comprehensive.py::TestIsValidPerson::test_not_person_exact_blocked PASSED [ 11%]
tests/test_comprehensive.py::TestIsValidPerson::test_collective_terms_blocked PASSED [ 11%]
tests/test_comprehensive.py::TestIsValidPerson::test_valid_names_accepted PASSED [ 11%]
tests/test_comprehensive.py::TestClassifyTone::test_heroic_text PASSED   [ 11%]
tests/test_comprehensive.py::TestClassifyTone::test_neutral_text PASSED  [ 11%]
tests/test_comprehensive.py::TestClassifyTone::test_empty_text PASSED    [ 11%]
tests/test_comprehensive.py::TestClassifyNature::test_military_event PASSED [ 11%]
tests/test_comprehensive.py::TestClassifyNature::test_empty_text PASSED  [ 11%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_required_sections_exist PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_person_aliases_all_have_list_values PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_topic_synonyms_all_have_list_values PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_dynasty_aliases_all_have_list_values PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_no_empty_canonical_keys PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_no_alias_duplicates_across_canonicals PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_hai_ba_trung_in_person_aliases PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_critical_topics_present PASSED [ 12%]
tests/test_comprehensive.py::TestKnowledgeBaseIntegrity::test_critical_dynasties_present PASSED [ 12%]
tests/test_comprehensive.py::TestScanByEntitiesTextFallback::test_fallback_finds_hai_ba_trung_in_text PASSED [ 13%]
tests/test_comprehensive.py::TestScanByEntitiesTextFallback::test_fallback_finds_quang_trung_via_alias PASSED [ 13%]
tests/test_comprehensive.py::TestScanByEntitiesTextFallback::test_index_direct_lookup_still_works PASSED [ 13%]
tests/test_comprehensive.py::TestScanByEntitiesTextFallback::test_empty_resolved_returns_empty PASSED [ 13%]
tests/test_comprehensive.py::TestScanByEntitiesTextFallback::test_nonexistent_person_returns_empty PASSED [ 13%]
tests/test_comprehensive.py::TestCheckRelevanceAliasAware::test_quang_trung_matches_nguyen_hue_doc PASSED [ 13%]
tests/test_comprehensive.py::TestCheckRelevanceAliasAware::test_hai_ba_trung_matches_trung_trac_doc PASSED [ 13%]
tests/test_comprehensive.py::TestCheckRelevanceAliasAware::test_irrelevant_doc_rejected PASSED [ 13%]
tests/test_comprehensive.py::TestCheckRelevanceAliasAware::test_dynasty_filter_overrides PASSED [ 13%]
tests/test_comprehensive.py::TestCheckRelevanceAliasAware::test_dynasty_filter_rejects_mismatch PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_all_person_aliases_resolve PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_all_dynasty_aliases_resolve PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_all_topic_synonyms_resolve PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_canonical_person_self_resolves PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_empty_query PASSED [ 14%]
tests/test_comprehensive.py::TestResolveEntitiesDataDriven::test_gibberish_query PASSED [ 14%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_hai_ba_trung_e2e PASSED [ 14%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_quang_trung_e2e PASSED [ 14%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_nha_tran_e2e PASSED [ 15%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_le_loi_alias_e2e PASSED [ 15%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_ngo_quyen_bach_dang_e2e PASSED [ 15%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_van_mieu_topic_e2e PASSED [ 15%]
tests/test_comprehensive.py::TestEndToEndIntegration::test_bac_ho_alias_e2e PASSED [ 15%]
tests/test_comprehensive.py::TestEntityRegistryAliasConsistency::test_all_kb_person_aliases_in_registry PASSED [ 15%]
tests/test_comprehensive.py::TestHardcodedPatterns::test_patterns_exist PASSED [ 15%]
tests/test_comprehensive.py::TestHardcodedPatterns::test_each_pattern_is_tuple_of_regex_and_string PASSED [ 15%]
tests/test_comprehensive.py::TestHardcodedPatterns::test_all_patterns_trigger PASSED [ 15%]
tests/test_comprehensive.py::TestHardcodedPatterns::test_case_insensitive_hai_ba_trung PASSED [ 16%]
tests/test_comprehensive.py::TestNewTopicSynonyms::test_bach_dang_topic_exists PASSED [ 16%]
tests/test_comprehensive.py::TestNewTopicSynonyms::test_hai_ba_trung_topic_exists PASSED [ 16%]
tests/test_comprehensive.py::TestNewTopicSynonyms::test_van_mieu_topic_exists PASSED [ 16%]
tests/test_comprehensive.py::TestNewTopicSynonyms::test_ngo_quyen_topic_exists PASSED [ 16%]
tests/test_comprehensive.py::TestNewTopicSynonyms::test_le_loi_topic_exists PASSED [ 16%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_unicode_diacritics PASSED [ 16%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_very_long_query PASSED [ 16%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_special_characters_in_query PASSED [ 16%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_numbers_only_query PASSED [ 17%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_scan_max_results_respected PASSED [ 17%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_check_query_relevance_empty_doc PASSED [ 17%]
tests/test_comprehensive.py::TestEdgeCasesRobust::test_extract_keywords_none_safe PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_person_year_conflict_tran_hung_dao_1945 PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_person_year_conflict_ho_chi_minh_1500 PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_person_year_conflict_alias_quang_trung PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_dynasty_year_conflict_nguyen_2000 PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_dynasty_year_conflict_nha_ly_1885 PASSED [ 17%]
tests/test_conflict_detector.py::TestConflictDetector::test_dynasty_short_name_tran_2000 PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_range_no_intersection PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_range_has_intersection PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_valid_person_year_intersection PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_valid_dynasty_year PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_valid_ho_chi_minh_1945 PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_unknown_entity_no_crash PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_no_year_constraint PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_no_entities_with_year PASSED [ 18%]
tests/test_conflict_detector.py::TestConflictDetector::test_empty_query_info PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_multiple_entities_one_conflict PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_vo_nguyen_giap_1954 PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_custom_metadata PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_boundary_year_start PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_boundary_year_end PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_boundary_year_just_outside PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_partial_range_overlap PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_self_conflict_year_outside_range PASSED [ 19%]
tests/test_conflict_detector.py::TestConflictDetector::test_self_conflict_year_inside_range PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_year_range_event_has_year_range_overlap PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_year_range_event_has_year_range_no_overlap PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_year_range_event_has_year_only PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_year_range_event_has_year_outside PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_year_range_event_no_temporal_data PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_entity_scan_intent_still_checks_temporal PASSED [ 20%]
tests/test_conflict_detector.py::TestAnswerValidatorTemporal::test_entity_scan_intent_skips_entity_match PASSED [ 20%]
tests/test_conflict_detector.py::TestTopicSeparation::test_topic_not_used_in_conflict_detection PASSED [ 20%]
tests/test_conflict_detector.py::TestTopicSeparation::test_topic_not_rejected_by_hard_filter PASSED [ 21%]
tests/test_conflict_detector.py::TestTopicSeparation::test_person_still_enforced_even_with_topics PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_cross_entity_conflict_no_overlap PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_cross_entity_overlap_valid PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_person_dynasty_no_overlap PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_three_entities_no_global_intersection PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_boundary_overlap_inclusive PASSED [ 21%]
tests/test_conflict_detector.py::TestCrossEntityConflict::test_missing_metadata_safe_skip PASSED [ 21%]
tests/test_conflict_detector.py::TestInvariantRegression::test_global_intersection_invariant_property PASSED [ 21%]
tests/test_conflict_detector.py::TestInvariantRegression::test_entity_order_independence PASSED [ 22%]
tests/test_conflict_detector.py::TestInvariantRegression::test_detect_idempotent PASSED [ 22%]
tests/test_conflict_detector.py::TestInvariantRegression::test_metadata_version_stable PASSED [ 22%]
tests/test_conflict_detector.py::TestInvariantRegression::test_random_global_intersection_stability PASSED [ 22%]
tests/test_conflict_detector.py::TestInvariantRegression::test_conflict_reason_explainable PASSED [ 22%]
tests/test_conflict_detector.py::TestEraMembership::test_valid_membership PASSED [ 22%]
tests/test_conflict_detector.py::TestEraMembership::test_invalid_membership PASSED [ 22%]
tests/test_conflict_detector.py::TestEraMembership::test_multiple_persons_one_wrong PASSED [ 22%]
tests/test_conflict_detector.py::TestEraMembership::test_no_era_field_safe_skip PASSED [ 22%]
tests/test_conflict_detector.py::TestEraMembership::test_no_dynasty_in_query PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_multi_era_person_valid PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_shorthand_normalization PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_metadata_version_v21 PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_all_era_fields_strict PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_fuzz_synthetic_queries_stability PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_determinism_1000x PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_entity_order_independence PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_duplicate_entity_no_double_conflict PASSED [ 23%]
tests/test_conflict_detector.py::TestEraMembership::test_metadata_all_persons_have_era PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_cross_phase_short_circuit PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_metadata_hash_guard PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_normalization_map_hash_guard PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_relation_type_guard_live_during PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_relation_type_guard_none PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_ambiguous_dynasty_nha_le_valid PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_ambiguous_dynasty_nha_le_invalid PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_ambiguous_dynasty_era_mismatch PASSED [ 24%]
tests/test_conflict_detector.py::TestEraMembership::test_multi_dynasty_valid PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_multi_dynasty_invalid PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_multi_dynasty_era_mismatch_isolated PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_nguyen_trai_nha_le_pass PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_nguyen_kim_nha_le_pass PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_le_hoan_nha_le_fail PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_le_hoan_tien_le_pass PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_nguyen_trai_hau_le_pass PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_le_hoan_hau_le_fail PASSED [ 25%]
tests/test_conflict_detector.py::TestEraMembership::test_le_live_during_skip PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_implicit_belong_to_patterns[Nguy\u1ec5n Tr\xe3i tri\u1ec1u L\xea-tri\u1ec1u] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_implicit_belong_to_patterns[Nguy\u1ec5n Tr\xe3i d\u01b0\u1edbi tri\u1ec1u L\xea-d\u01b0\u1edbi tri\u1ec1u] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_implicit_belong_to_patterns[Nguy\u1ec5n Tr\xe3i ph\u1ee5c v\u1ee5 nh\xe0 L\xea-ph\u1ee5c v\u1ee5] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_live_during_priority[Nguy\u1ec5n Tr\xe3i s\u1ed1ng cu\u1ed1i th\u1eddi nh\xe0 L\xea] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_live_during_priority[L\xea Ho\xe0n sinh v\xe0o th\u1eddi nh\xe0 L\xea] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_live_during_priority[Nguy\u1ec5n Tr\xe3i ra \u0111\u1eddi th\u1eddi nh\xe0 Tr\u1ea7n] PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_multi_person_single_dynasty_partial_conflict PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_multi_dynasty_ambiguous_conflict PASSED [ 26%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_unknown_dynasty_no_crash PASSED [ 27%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_all_persons_must_have_era PASSED [ 27%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_normalization_map_purity PASSED [ 27%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_metadata_immutability PASSED [ 27%]
tests/test_conflict_detector.py::TestEnterpriseEdgeCases::test_randomized_order_fuzz_100x PASSED [ 27%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_no_mutation PASSED [ 27%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_alias_expansion PASSED [ 27%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_person_overlap_note PASSED [ 27%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_era_alignment_warning PASSED [ 27%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_skipped_on_conflict PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_multiple_person_overlap PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_no_duplicate_notes PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_alias_case_insensitive PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_does_not_mutate_metadata PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_determinism PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_phase4_confidence_consistency PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_confidence_high_exact_era_match PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_confidence_ambiguous_era PASSED [ 28%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_explainability_json_structure PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_soft_warning_does_not_override_conflict PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_multi_era_person_no_conflict PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_metadata_version_freeze PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_guardrail_truncation PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_guardrail_topic_drift PASSED [ 29%]
tests/test_conflict_detector.py::TestPhase4SoftSemantic::test_guardrail_year_hallucination PASSED [ 29%]
tests/test_context7_integration.py::TestContext7Integration::test_tran_dynasty_mongol_wars_query PASSED [ 29%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_filters_irrelevant_events PASSED [ 29%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_ranks_by_relevance PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_service_extract_query_focus PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_service_calculate_relevance_score PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_service_filter_and_rank PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_context7_service_validate_answer PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_hai_ba_trung_wrong_person_filter PASSED [ 30%]
tests/test_context7_integration.py::TestContext7Integration::test_dai_viet_keyword_filter PASSED [ 30%]
tests/test_data_quality.py::TestFAISSIndexExists::test_meta_json_exists PASSED [ 30%]
tests/test_data_quality.py::TestFAISSIndexExists::test_history_index_exists PASSED [ 30%]
tests/test_data_quality.py::TestFAISSIndexExists::test_meta_json_valid_structure PASSED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_documents_have_required_fields PASSED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_years_are_valid PASSED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_no_exact_duplicate_events SKIPPED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_no_duplicate_events_per_year SKIPPED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_year_1911_has_reasonable_count PASSED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_minimum_document_count PASSED [ 31%]
tests/test_data_quality.py::TestDataQuality::test_year_coverage PASSED   [ 31%]
tests/test_data_quality.py::TestDeduplicationQuality::test_no_similar_events_same_year SKIPPED [ 31%]
tests/test_date_utils.py::test_safe_year_valid_int PASSED                [ 32%]
tests/test_date_utils.py::test_safe_year_valid_string PASSED             [ 32%]
tests/test_date_utils.py::test_safe_year_zero PASSED                     [ 32%]
tests/test_date_utils.py::test_safe_year_negative_bce PASSED             [ 32%]
tests/test_date_utils.py::test_safe_year_none PASSED                     [ 32%]
tests/test_date_utils.py::test_safe_year_empty_string PASSED             [ 32%]
tests/test_date_utils.py::test_safe_year_invalid_string PASSED           [ 32%]
tests/test_date_utils.py::test_safe_year_list PASSED                     [ 32%]
tests/test_date_utils.py::test_safe_year_dict PASSED                     [ 32%]
tests/test_date_utils.py::test_safe_year_bool_true PASSED                [ 33%]
tests/test_date_utils.py::test_safe_year_bool_false PASSED               [ 33%]
tests/test_date_utils.py::test_safe_year_float PASSED                    [ 33%]
tests/test_date_utils.py::test_safe_year_custom_default PASSED           [ 33%]
tests/test_date_utils.py::test_safe_year_custom_default_invalid PASSED   [ 33%]
tests/test_date_utils.py::test_safe_year_negative_not_allowed PASSED     [ 33%]
tests/test_date_utils.py::test_safe_year_negative_allowed PASSED         [ 33%]
tests/test_date_utils.py::test_safe_year_max_clamp PASSED                [ 33%]
tests/test_date_utils.py::test_safe_year_within_max PASSED               [ 33%]
tests/test_date_utils.py::test_safe_year_extreme_negative PASSED         [ 34%]
tests/test_e2e_api.py::TestHealthEndpoints::test_health_returns_200_immediately PASSED [ 34%]
tests/test_e2e_api.py::TestHealthEndpoints::test_health_detailed_returns_structure PASSED [ 34%]
tests/test_e2e_api.py::TestChatAPI::test_chat_with_year_query PASSED     [ 34%]
tests/test_e2e_api.py::TestChatAPI::test_chat_with_identity_query PASSED [ 34%]
tests/test_e2e_api.py::TestChatAPI::test_chat_no_duplicate_events PASSED [ 34%]
tests/test_e2e_api.py::TestChatAPI::test_chat_max_events_limit PASSED    [ 34%]
tests/test_e2e_api.py::TestChatAPI::test_chat_empty_query PASSED         [ 34%]
tests/test_e2e_api.py::TestAPIEdgeCases::test_missing_query_field PASSED [ 34%]
tests/test_e2e_api.py::TestAPIEdgeCases::test_invalid_json PASSED        [ 35%]
tests/test_e2e_api.py::TestAPIEdgeCases::test_special_characters_in_query PASSED [ 35%]
tests/test_edge_cases.py::TestEmptyQueryHandling::test_engine_answer_empty_string PASSED [ 35%]
tests/test_edge_cases.py::TestEmptyQueryHandling::test_engine_answer_whitespace_only PASSED [ 35%]
tests/test_edge_cases.py::TestEmptyQueryHandling::test_semantic_search_empty_query PASSED [ 35%]
tests/test_edge_cases.py::TestEmptyQueryHandling::test_resolve_entities_empty_query PASSED [ 35%]
tests/test_edge_cases.py::TestSpecialCharactersQuery::test_query_with_only_punctuation PASSED [ 35%]
tests/test_edge_cases.py::TestSpecialCharactersQuery::test_query_with_unicode_symbols PASSED [ 35%]
tests/test_edge_cases.py::TestSpecialCharactersQuery::test_query_with_mixed_special_chars PASSED [ 35%]
tests/test_edge_cases.py::TestSpecialCharactersQuery::test_query_with_sql_injection_attempt PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_negative_year_extraction PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_year_too_large PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_year_too_small PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_year_range_with_negative_start PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_year_range_with_invalid_end PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_year_range_backwards PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_query_with_year_zero PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_query_with_year_boundary_39 PASSED [ 36%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_query_with_year_boundary_40 PASSED [ 37%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_query_with_year_boundary_2025 PASSED [ 37%]
tests/test_edge_cases.py::TestYearOutOfBounds::test_query_with_year_boundary_2026 PASSED [ 37%]
tests/test_edge_cases.py::TestEventsMissingRequiredFields::test_synthesize_with_events_missing_all_fields PASSED [ 37%]
tests/test_edge_cases.py::TestEventsMissingRequiredFields::test_deduplicate_events_with_missing_year PASSED [ 37%]
tests/test_edge_cases.py::TestEventsMissingRequiredFields::test_format_complete_answer_with_mixed_years PASSED [ 37%]
tests/test_edge_cases.py::TestFAISSReturnsNoResults::test_semantic_search_no_results_threshold PASSED [ 37%]
tests/test_edge_cases.py::TestFAISSReturnsNoResults::test_engine_answer_with_no_faiss_results PASSED [ 37%]
tests/test_edge_cases.py::TestKnowledgeBaseEntityNotFound::test_resolve_unknown_person PASSED [ 37%]
tests/test_edge_cases.py::TestKnowledgeBaseEntityNotFound::test_resolve_unknown_dynasty PASSED [ 38%]
tests/test_edge_cases.py::TestKnowledgeBaseEntityNotFound::test_resolve_unknown_place PASSED [ 38%]
tests/test_edge_cases.py::TestKnowledgeBaseEntityNotFound::test_scan_by_entities_with_unresolved_entities PASSED [ 38%]
tests/test_edge_cases.py::TestEmptyDocumentStore::test_semantic_search_empty_documents PASSED [ 38%]
tests/test_edge_cases.py::TestEmptyDocumentStore::test_engine_answer_empty_documents PASSED [ 38%]
tests/test_edge_cases.py::TestEmptyDocumentStore::test_scan_by_entities_empty_documents PASSED [ 38%]
tests/test_edge_cases.py::TestVeryLongQueries::test_query_with_1000_chars PASSED [ 38%]
tests/test_edge_cases.py::TestVeryLongQueries::test_query_with_10000_chars PASSED [ 38%]
tests/test_edge_cases.py::TestMalformedEventData::test_event_with_invalid_year_type PASSED [ 38%]
tests/test_edge_cases.py::TestMalformedEventData::test_event_with_non_string_story PASSED [ 39%]
tests/test_engine.py::TestIdentityCreator::test_ban_la_ai PASSED         [ 39%]
tests/test_engine.py::TestIdentityCreator::test_gioi_thieu_ban_than PASSED [ 39%]
tests/test_engine.py::TestIdentityCreator::test_ai_tao_ra_ban PASSED     [ 39%]
tests/test_engine.py::TestIdentityCreator::test_ai_phat_trien_ban PASSED [ 39%]
tests/test_engine.py::TestIdentityCreator::test_creator_before_identity PASSED [ 39%]
tests/test_engine.py::TestYearQueries::test_single_year PASSED           [ 39%]
tests/test_engine.py::TestYearQueries::test_year_range PASSED            [ 39%]
tests/test_engine.py::TestYearQueries::test_multiple_years PASSED        [ 39%]
tests/test_engine.py::TestYearQueries::test_no_data_found PASSED         [ 40%]
tests/test_engine.py::TestPersonAliases::test_tran_hung_dao_canonical PASSED [ 40%]
tests/test_engine.py::TestPersonAliases::test_tran_quoc_tuan_alias PASSED [ 40%]
tests/test_engine.py::TestPersonAliases::test_hung_dao_vuong_alias PASSED [ 40%]
tests/test_engine.py::TestPersonAliases::test_hai_ba_trung_canonical PASSED [ 40%]
tests/test_engine.py::TestPersonAliases::test_trung_trac_alias PASSED    [ 40%]
tests/test_engine.py::TestPersonAliases::test_quang_trung_alias PASSED   [ 40%]
tests/test_engine.py::TestPersonAliases::test_bac_ho_alias PASSED        [ 40%]
tests/test_engine.py::TestPersonAliases::test_nguyen_ai_quoc_alias PASSED [ 40%]
tests/test_engine.py::TestPersonAliases::test_ngo_vuong_alias PASSED     [ 41%]
tests/test_engine.py::TestPersonAliases::test_le_thai_to_alias PASSED    [ 41%]
tests/test_engine.py::TestPersonAliases::test_dinh_tien_hoang_alias PASSED [ 41%]
tests/test_engine.py::TestPersonAliases::test_trieu_thi_trinh_alias PASSED [ 41%]
tests/test_engine.py::TestDynastyAliases::test_nha_tran PASSED           [ 41%]
tests/test_engine.py::TestDynastyAliases::test_trieu_ly PASSED           [ 41%]
tests/test_engine.py::TestDynastyAliases::test_thoi_le PASSED            [ 41%]
tests/test_engine.py::TestDynastyAliases::test_nha_nguyen PASSED         [ 41%]
tests/test_engine.py::TestDynastyAliases::test_nha_dinh PASSED           [ 41%]
tests/test_engine.py::TestDynastyAliases::test_tay_son_dynasty PASSED    [ 42%]
tests/test_engine.py::TestDynastyAliases::test_trieu_tran_alias PASSED   [ 42%]
tests/test_engine.py::TestDynastyAliases::test_thoi_tu_chu PASSED        [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_mong_co_to_nguyen_mong PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_mong_nguyen_to_nguyen_mong PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_quan_nguyen_to_nguyen_mong PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_quan_mong_to_nguyen_mong PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_van_mieu_to_giao_duc PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_quoc_tu_giam_to_giao_duc PASSED [ 42%]
tests/test_engine.py::TestTopicSynonyms::test_thuc_dan_phap_to_phap_thuoc PASSED [ 43%]
tests/test_engine.py::TestTopicSynonyms::test_tong_khoi_nghia_to_cach_mang PASSED [ 43%]
tests/test_engine.py::TestTopicSynonyms::test_bai_tho_than_to_nam_quoc PASSED [ 43%]
tests/test_engine.py::TestTopicSynonyms::test_tran_dien_bien_phu PASSED  [ 43%]
tests/test_engine.py::TestPlaceDetection::test_bach_dang_place PASSED    [ 43%]
tests/test_engine.py::TestPlaceDetection::test_dai_viet_place PASSED     [ 43%]
tests/test_engine.py::TestPlaceDetection::test_dong_da_place PASSED      [ 43%]
tests/test_engine.py::TestPlaceDetection::test_dien_bien_phu_place PASSED [ 43%]
tests/test_engine.py::TestMultiEntityCombined::test_person_and_dynasty PASSED [ 43%]
tests/test_engine.py::TestMultiEntityCombined::test_person_and_place PASSED [ 44%]
tests/test_engine.py::TestMultiEntityCombined::test_person_alias_and_topic PASSED [ 44%]
tests/test_engine.py::TestMultiEntityCombined::test_dynasty_and_topic PASSED [ 44%]
tests/test_engine.py::TestMultiEntityCombined::test_multiple_persons PASSED [ 44%]
tests/test_engine.py::TestMultiEntityCombined::test_all_entities_combined PASSED [ 44%]
tests/test_engine.py::TestScanByEntities::test_scan_person PASSED        [ 44%]
tests/test_engine.py::TestScanByEntities::test_scan_dynasty PASSED       [ 44%]
tests/test_engine.py::TestScanByEntities::test_scan_place PASSED         [ 44%]
tests/test_engine.py::TestScanByEntities::test_scan_combined_person_dynasty PASSED [ 44%]
tests/test_engine.py::TestScanByEntities::test_scan_empty_returns_empty PASSED [ 45%]
tests/test_engine.py::TestScanByEntities::test_scan_nonexistent_person PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_multi_entity_intent PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_dynasty_intent PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_topic_intent PASSED  [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_place_intent PASSED  [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_definition_intent PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_hai_ba_trung_query PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_van_mieu_query PASSED [ 45%]
tests/test_engine.py::TestEngineIntentRouting::test_dai_viet_query PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_nguyen_mong_variations PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_ho_chi_minh_aliases PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_tran_hung_dao_aliases PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_hai_ba_trung_aliases PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_dynasty_alias_variations PASSED [ 46%]
tests/test_engine.py::TestPhrasingVariations::test_quang_trung_nguyen_hue PASSED [ 46%]
tests/test_engine.py::TestEdgeCases::test_empty_query PASSED             [ 46%]
tests/test_engine.py::TestEdgeCases::test_gibberish_query PASSED         [ 46%]
tests/test_engine.py::TestEdgeCases::test_case_insensitive PASSED        [ 47%]
tests/test_engine.py::TestEdgeCases::test_unicode_normalization PASSED   [ 47%]
tests/test_engine.py::TestEdgeCases::test_scan_with_max_results_limit PASSED [ 47%]
tests/test_engine.py::TestEdgeCases::test_partial_name_no_false_positive PASSED [ 47%]
tests/test_engine.py::TestFormatOutput::test_format_groups_by_year PASSED [ 47%]
tests/test_engine.py::TestFormatOutput::test_format_empty_returns_none PASSED [ 47%]
tests/test_engine.py::TestFormatOutput::test_clean_story_text PASSED     [ 47%]
tests/test_engine.py::TestImplicitContextDetection::test_vietnam_scope_detected PASSED [ 47%]
tests/test_engine.py::TestImplicitContextDetection::test_vietnam_scope_not_detected PASSED [ 47%]
tests/test_engine.py::TestImplicitContextDetection::test_broad_query_detected PASSED [ 48%]
tests/test_engine.py::TestImplicitContextDetection::test_broad_query_not_detected PASSED [ 48%]
tests/test_engine.py::TestImplicitContextDetection::test_resistance_terms_detected PASSED [ 48%]
tests/test_engine.py::TestImplicitContextDetection::test_resistance_expansion PASSED [ 48%]
tests/test_engine.py::TestImplicitContextDetection::test_expand_query_context PASSED [ 48%]
tests/test_engine.py::TestNonDiscriminatingKeywords::test_filter_removes_vietnam PASSED [ 48%]
tests/test_engine.py::TestNonDiscriminatingKeywords::test_filter_removes_all_scope_terms PASSED [ 48%]
tests/test_engine.py::TestNonDiscriminatingKeywords::test_filter_preserves_real_keywords PASSED [ 48%]
tests/test_engine.py::TestImplicitContextEngine::test_khang_chien_viet_nam PASSED [ 48%]
tests/test_engine.py::TestImplicitContextEngine::test_lich_su_viet_nam_broad PASSED [ 49%]
tests/test_engine.py::TestImplicitContextEngine::test_chong_ngoai_xam_expansion PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_detect_vietnam_nation PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_detect_vietnam_territory PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_detect_vietnam_ethnic PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_detect_vietnam_default_nation PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_detect_no_vietnam PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_structure_dynasty_timeline PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_structure_chronological PASSED [ 49%]
tests/test_engine.py::TestSemanticIntentClassification::test_structure_thematic PASSED [ 50%]
tests/test_engine.py::TestSemanticIntentClassification::test_intent_dynasty_timeline PASSED [ 50%]
tests/test_engine.py::TestSemanticIntentClassification::test_intent_resistance_national PASSED [ 50%]
tests/test_engine.py::TestSemanticIntentClassification::test_intent_civil_war PASSED [ 50%]
tests/test_engine.py::TestSemanticIntentClassification::test_intent_generic_specific_entity PASSED [ 50%]
tests/test_engine.py::TestSemanticIntentClassification::test_intent_broad_history PASSED [ 50%]
tests/test_engine.py::TestStructuredRetrieval::test_scan_national_resistance PASSED [ 50%]
tests/test_engine.py::TestStructuredRetrieval::test_scan_by_dynasty_timeline PASSED [ 50%]
tests/test_engine.py::TestStructuredRetrieval::test_engine_resistance_intent PASSED [ 50%]
tests/test_engine.py::TestStructuredRetrieval::test_engine_dynasty_timeline_intent PASSED [ 51%]
tests/test_engine.py::TestPersonDynastyCollision::test_nguyen_hue_resolves_as_person PASSED [ 51%]
tests/test_engine.py::TestPersonDynastyCollision::test_nguyen_hue_unaccented PASSED [ 51%]
tests/test_engine.py::TestPersonDynastyCollision::test_entity_resolution_no_dynasty_collision PASSED [ 51%]
tests/test_engine.py::TestPersonDynastyCollision::test_nha_nguyen_still_works PASSED [ 51%]
tests/test_engine.py::TestFactCheckDetection::test_wrong_year_phai_khong PASSED [ 51%]
tests/test_engine.py::TestFactCheckDetection::test_correct_year_dung_khong PASSED [ 51%]
tests/test_engine.py::TestFactCheckDetection::test_co_phai_pattern PASSED [ 51%]
tests/test_engine.py::TestFactCheckDetection::test_reversed_year_first PASSED [ 51%]
tests/test_engine.py::TestFactCheckDetection::test_casual_ha_suffix PASSED [ 52%]
tests/test_engine.py::TestFactCheckDetection::test_casual_a_suffix PASSED [ 52%]
tests/test_engine.py::TestFactCheckDetection::test_dien_ra_phai_khong PASSED [ 52%]
tests/test_engine.py::TestFactCheckDetection::test_not_fact_check_when_question PASSED [ 52%]
tests/test_engine.py::TestFactCheckDetection::test_not_fact_check_normal_query PASSED [ 52%]
tests/test_engine.py::TestFactCheckDetection::test_not_fact_check_greeting PASSED [ 52%]
tests/test_engine.py::TestFactCheckQueries::test_wrong_year_correction PASSED [ 52%]
tests/test_engine.py::TestFactCheckQueries::test_correct_year_confirmation PASSED [ 52%]
tests/test_engine.py::TestFactCheckQueries::test_fact_check_hcm_wrong_year PASSED [ 52%]
tests/test_engine.py::TestFactCheckQueries::test_fact_check_dbp_correct PASSED [ 53%]
tests/test_engine.py::TestQuestionVariants::test_ask_year_of_event PASSED [ 53%]
tests/test_engine.py::TestQuestionVariants::test_ask_who_is_person PASSED [ 53%]
tests/test_engine.py::TestQuestionVariants::test_ask_what_happened PASSED [ 53%]
tests/test_engine.py::TestQuestionVariants::test_casual_question PASSED  [ 53%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_empty_string PASSED [ 53%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_year_prefix_nam PASSED [ 53%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_year_prefix_parenthetical PASSED [ 53%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_year_prefix_dash PASSED [ 53%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_bullet_strip PASSED [ 54%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_markdown_bold_strip PASSED [ 54%]
tests/test_engine_dedup.py::TestNormalizeForDedup::test_equivalent_formats PASSED [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_empty_list PASSED  [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_exact_duplicates PASSED [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_near_duplicate_year_prefix PASSED [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_different_events_preserved PASSED [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_keeps_longer_story PASSED [ 54%]
tests/test_engine_dedup.py::TestAggregateEvents::test_year_zero_handling PASSED [ 54%]
tests/test_engine_dedup.py::TestIsSimilarEvent::test_exact_match PASSED  [ 55%]
tests/test_engine_dedup.py::TestIsSimilarEvent::test_year_prefix_difference PASSED [ 55%]
tests/test_engine_dedup.py::TestIsSimilarEvent::test_containment PASSED  [ 55%]
tests/test_engine_dedup.py::TestIsSimilarEvent::test_completely_different PASSED [ 55%]
tests/test_engine_dedup.py::TestIsSimilarEvent::test_keyword_overlap PASSED [ 55%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_empty_text PASSED [ 55%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_no_duplicates PASSED [ 55%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_exact_duplicate_lines PASSED [ 55%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_near_duplicate_lines PASSED [ 55%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_preserves_headers PASSED [ 56%]
tests/test_engine_dedup.py::TestDeduplicateAnswer::test_preserves_empty_lines PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_exact_user_reported_case PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_year_marker_split_dedup PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_sentence_level_dedup PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_no_false_positive_short PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_no_false_positive_distinct PASSED [ 56%]
tests/test_engine_dedup.py::TestIntraLineDedup::test_dedup_answer_single_line PASSED [ 56%]
tests/test_engine_dedup.py::TestCanonicalizeYearFormat::test_parenthetical_year PASSED [ 56%]
tests/test_engine_dedup.py::TestCanonicalizeYearFormat::test_preserves_normal_text PASSED [ 57%]
tests/test_engine_dedup.py::TestIntegration::test_full_pipeline_removes_duplicates PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel1BasicSanity::test_01_ask_exact_year PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel1BasicSanity::test_02_verify_wrong_year PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel1BasicSanity::test_03_compare_different_eras PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel1BasicSanity::test_04_alias_explicit PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel2ControlledLogic::test_05_partially_overlapping_periods PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel2ControlledLogic::test_06_multi_entity_timeline_sort PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel2ControlledLogic::test_07_implicit_constraint PASSED [ 57%]
tests/test_enterprise_levels.py::TestLevel3DriftTraps::test_08_topic_drift_trap PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel3DriftTraps::test_09_phantom_year_trap PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel3DriftTraps::test_10_truncation_trap PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel4MultiLayerEdge::test_11_mixed_correct_incorrect PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel4MultiLayerEdge::test_12_double_intent PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel4MultiLayerEdge::test_13_alias_trap_no_expansion PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel4MultiLayerEdge::test_14_similar_name_trap PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel5Adversarial::test_15_contradictory_question PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel5Adversarial::test_16_timeline_paradox PASSED [ 58%]
tests/test_enterprise_levels.py::TestLevel5Adversarial::test_17_prompt_injection PASSED [ 59%]
tests/test_enterprise_levels.py::TestLevel5Adversarial::test_18_gibberish_input PASSED [ 59%]
tests/test_enterprise_levels.py::TestLevel6SystemIntegrity::test_19_long_input_stress PASSED [ 59%]
tests/test_enterprise_levels.py::TestLevel6SystemIntegrity::test_20_mixed_era_query PASSED [ 59%]
tests/test_enterprise_levels.py::TestLevel6SystemIntegrity::test_21_year_range_validation PASSED [ 59%]
tests/test_enterprise_levels.py::TestLevel6SystemIntegrity::test_22_sql_injection_safety PASSED [ 59%]
tests/test_enterprise_levels.py::TestBonusStressTests::test_23_large_entity_set PASSED [ 59%]
tests/test_enterprise_levels.py::TestBonusStressTests::test_24_data_scope_query PASSED [ 59%]
tests/test_enterprise_levels.py::TestBonusStressTests::test_25_greeting_handling PASSED [ 59%]
tests/test_enterprise_levels.py::TestBonusStressTests::test_26_fact_check_correct_year PASSED [ 60%]
tests/test_enterprise_levels.py::TestBonusStressTests::test_27_unicode_stress PASSED [ 60%]
tests/test_entity_normalizer.py::TestExpandTruncatedNames::test_expand_ho_c PASSED [ 60%]
tests/test_entity_normalizer.py::TestExpandTruncatedNames::test_expand_nguyen_t PASSED [ 60%]
tests/test_entity_normalizer.py::TestExpandTruncatedNames::test_no_false_positive_abbreviations PASSED [ 60%]
tests/test_entity_normalizer.py::TestExpandTruncatedNames::test_empty_input PASSED [ 60%]
tests/test_entity_normalizer.py::TestRemoveRedundantPronouns::test_bac_ho_replaced_when_canonical_present PASSED [ 60%]
tests/test_entity_normalizer.py::TestRemoveRedundantPronouns::test_bac_ho_kept_when_canonical_absent PASSED [ 60%]
tests/test_entity_normalizer.py::TestRemoveRedundantPronouns::test_cua_bac_replaced PASSED [ 60%]
tests/test_entity_normalizer.py::TestAnnotateFirstMention::test_annotate_alias_not_canonical PASSED [ 61%]
tests/test_entity_normalizer.py::TestAnnotateFirstMention::test_no_annotation_when_canonical_present PASSED [ 61%]
tests/test_entity_normalizer.py::TestNormalizeEntityNames::test_full_pipeline_no_crash PASSED [ 61%]
tests/test_entity_normalizer.py::TestNormalizeEntityNames::test_empty_and_none PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_brief_nam_nao PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_brief_nam_bao_nhieu PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_brief_khi_nao PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_brief_tom_tat PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_detailed_trinh_bay PASSED [ 61%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_detailed_chi_tiet PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_detailed_ke_ve PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_detailed_dien_bien PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_standard_default PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetectDetailLevel::test_standard_year_query PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetailLevelInClassifyIntent::test_classify_intent_has_detail_level PASSED [ 62%]
tests/test_entity_normalizer.py::TestDetailLevelInClassifyIntent::test_classify_intent_brief_query PASSED [ 62%]
tests/test_entity_normalizer.py::TestResponseStructure::test_response_has_confidence_field PASSED [ 62%]
tests/test_entity_normalizer.py::TestResponseStructure::test_response_has_evidence_ids PASSED [ 62%]
tests/test_entity_normalizer.py::TestCheckTruncatedNames::test_detect_ho_c PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTruncatedNames::test_detect_nguyen_t PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTruncatedNames::test_no_false_positive PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTruncatedNames::test_clean_text_passes PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTemporalMixing::test_detect_ungrounded_year PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTemporalMixing::test_grounded_years_pass PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTemporalMixing::test_no_event_years_passes PASSED [ 63%]
tests/test_entity_normalizer.py::TestCheckTemporalMixing::test_approximate_year_tolerance PASSED [ 63%]
tests/test_entity_normalizer.py::TestVerifierIntegration::test_verify_includes_truncated_names PASSED [ 63%]
tests/test_entity_normalizer.py::TestVerifierIntegration::test_verify_includes_temporal_mixing PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_typo_in_person_name PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_synonym_person_name PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_partial_match_person_name PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_different_word_order PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_extra_filler_words PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_casual_language PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_context7_fuzzy_matching PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_context7_synonym_matching PASSED [ 64%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_context7_partial_keyword_match PASSED [ 65%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_multiple_typos PASSED [ 65%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_mixed_vietnamese_english PASSED [ 65%]
tests/test_fuzzy_matching.py::TestFuzzyMatching::test_context7_filter_and_rank_fuzzy PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_english_hello PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_english_hi PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_vietnamese_xin_chao PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_vietnamese_chao_ban PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_casual_alo PASSED [ 65%]
tests/test_greeting_responses.py::TestGreetingResponses::test_good_morning PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_how_are_you PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_thank_you_english PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_thank_you_vietnamese PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_thank_you_casual PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_goodbye_english PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_goodbye_vietnamese PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_goodbye_casual PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_see_you PASSED [ 66%]
tests/test_greeting_responses.py::TestGreetingResponses::test_greeting_with_question PASSED [ 67%]
tests/test_greeting_responses.py::TestGreetingResponses::test_case_insensitive_greeting PASSED [ 67%]
tests/test_greeting_responses.py::TestGreetingResponses::test_greeting_with_punctuation PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_ky_niem_1000_nam PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_ki_niem_1000_nam_unaccented PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_hon_150_nam PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_gan_100_nam PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_tron_100_nam PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_1000_nam_thang_long PASSED [ 67%]
tests/test_intent_classifier.py::TestDurationGuard::test_150_nam_chia_cat PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_khoang_200_nam PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_100_nam_ke_tu PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_NOT_duration_nam_1000 PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_NOT_duration_nam_1945 PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_NOT_duration_plain_year PASSED [ 68%]
tests/test_intent_classifier.py::TestDurationGuard::test_NOT_duration_no_number PASSED [ 68%]
tests/test_intent_classifier.py::TestQuestionType::test_when_nam_nao PASSED [ 68%]
tests/test_intent_classifier.py::TestQuestionType::test_when_khi_nao PASSED [ 68%]
tests/test_intent_classifier.py::TestQuestionType::test_when_nam_bao_nhieu PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_when_english PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_who_la_ai PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_who_ai_la PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_who_english PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_list_cac_su_kien PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_list_nhung_gi PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_list_liet_ke PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_list_co_gi PASSED [ 69%]
tests/test_intent_classifier.py::TestQuestionType::test_list_lich_su PASSED [ 70%]
tests/test_intent_classifier.py::TestQuestionType::test_scope_co_du_lieu PASSED [ 70%]
tests/test_intent_classifier.py::TestQuestionType::test_scope_dataset PASSED [ 70%]
tests/test_intent_classifier.py::TestQuestionType::test_scope_pham_vi PASSED [ 70%]
tests/test_intent_classifier.py::TestQuestionType::test_default_what PASSED [ 70%]
tests/test_intent_classifier.py::TestDataScope::test_co_du_lieu_gi PASSED [ 70%]
tests/test_intent_classifier.py::TestDataScope::test_du_kien_cua_ban PASSED [ 70%]
tests/test_intent_classifier.py::TestDataScope::test_pham_vi_du_lieu PASSED [ 70%]
tests/test_intent_classifier.py::TestDataScope::test_co_lich_su_den_nam PASSED [ 70%]
tests/test_intent_classifier.py::TestDataScope::test_NOT_scope_regular PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_data_scope PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_year_range PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_multi_years PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_relationship PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_definition_person PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_person_query PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_dynasty_query PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_dynasty_timeline PASSED [ 71%]
tests/test_intent_classifier.py::TestClassifyIntent::test_event_query PASSED [ 72%]
tests/test_intent_classifier.py::TestClassifyIntent::test_year_specific PASSED [ 72%]
tests/test_intent_classifier.py::TestClassifyIntent::test_semantic_fallback PASSED [ 72%]
tests/test_intent_classifier.py::TestClassifyIntent::test_broad_history PASSED [ 72%]
tests/test_intent_classifier.py::TestClassifyIntent::test_resistance PASSED [ 72%]
tests/test_intent_classifier.py::TestClassifyIntent::test_resistance_broad PASSED [ 72%]
tests/test_intent_classifier.py::TestDurationGuardIntegration::test_1000_nam_thang_long_no_year PASSED [ 72%]
tests/test_intent_classifier.py::TestDurationGuardIntegration::test_hon_150_nam_no_year PASSED [ 72%]
tests/test_intent_classifier.py::TestDurationGuardIntegration::test_nam_1945_preserves_year PASSED [ 72%]
tests/test_intent_classifier.py::TestPersonWhenCombo::test_person_when_query PASSED [ 73%]
tests/test_intent_classifier.py::TestPersonWhenCombo::test_person_what_query PASSED [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_basic_passthrough PASSED     [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_abbreviation_vn PASSED       [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_abbreviation_dbp PASSED      [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_abbreviation_hcm PASSED      [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_typo_nguyen_huye PASSED      [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_typo_quangtrung PASSED       [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_unaccented_tran_hung_dao PASSED [ 73%]
tests/test_nlu.py::TestQueryRewriting::test_unaccented_bach_dang PASSED  [ 74%]
tests/test_nlu.py::TestQueryRewriting::test_unaccented_ho_chi_minh PASSED [ 74%]
tests/test_nlu.py::TestQueryRewriting::test_filler_removal PASSED        [ 74%]
tests/test_nlu.py::TestQueryRewriting::test_empty_query PASSED           [ 74%]
tests/test_nlu.py::TestQueryRewriting::test_whitespace_normalization PASSED [ 74%]
tests/test_nlu.py::TestQueryRewriting::test_mixed_case PASSED            [ 74%]
tests/test_nlu.py::TestUnaccentedDetection::test_fully_unaccented PASSED [ 74%]
tests/test_nlu.py::TestUnaccentedDetection::test_fully_accented PASSED   [ 74%]
tests/test_nlu.py::TestUnaccentedDetection::test_mixed_partial_accent PASSED [ 74%]
tests/test_nlu.py::TestUnaccentedDetection::test_empty_string PASSED     [ 75%]
tests/test_nlu.py::TestUnaccentedDetection::test_numbers_only PASSED     [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_single_person PASSED      [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_single_place PASSED       [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_dynasty PASSED            [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_topic PASSED              [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_multiple_terms PASSED     [ 75%]
tests/test_nlu.py::TestAccentRestoration::test_no_match PASSED           [ 75%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_exact_match_excluded PASSED [ 75%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_close_match PASSED      [ 76%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_threshold_filtering PASSED [ 76%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_empty_query PASSED      [ 76%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_empty_dict PASSED       [ 76%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_results_sorted_by_score PASSED [ 76%]
tests/test_nlu.py::TestFuzzyEntityMatching::test_deduplicated_results PASSED [ 76%]
tests/test_nlu.py::TestQuestionIntentDetection::test_person_search_ai_da PASSED [ 76%]
tests/test_nlu.py::TestQuestionIntentDetection::test_person_search_vi_tuong PASSED [ 76%]
tests/test_nlu.py::TestQuestionIntentDetection::test_event_search_chuyen_gi PASSED [ 76%]
tests/test_nlu.py::TestQuestionIntentDetection::test_event_search_dieu_gi PASSED [ 77%]
tests/test_nlu.py::TestQuestionIntentDetection::test_time_search_khi_nao PASSED [ 77%]
tests/test_nlu.py::TestQuestionIntentDetection::test_time_search_nam_nao PASSED [ 77%]
tests/test_nlu.py::TestQuestionIntentDetection::test_comparison_so_sanh PASSED [ 77%]
tests/test_nlu.py::TestQuestionIntentDetection::test_no_pattern PASSED   [ 77%]
tests/test_nlu.py::TestQueryExpansion::test_person_variation PASSED      [ 77%]
tests/test_nlu.py::TestQueryExpansion::test_person_and_place PASSED      [ 77%]
tests/test_nlu.py::TestQueryExpansion::test_empty_resolved_with_phonetic PASSED [ 77%]
tests/test_nlu.py::TestQueryExpansion::test_topic_variation PASSED       [ 77%]
tests/test_nlu.py::TestEngineWithNLU::test_unaccented_query_finds_person PASSED [ 78%]
tests/test_nlu.py::TestEngineWithNLU::test_abbreviation_hcm_finds_person PASSED [ 78%]
tests/test_nlu.py::TestEngineWithNLU::test_typo_query_finds_person PASSED [ 78%]
tests/test_nlu.py::TestEngineWithNLU::test_identity_still_works PASSED   [ 78%]
tests/test_nlu.py::TestEngineWithNLU::test_creator_still_works PASSED    [ 78%]
tests/test_nlu.py::TestEngineWithNLU::test_no_data_suggestion PASSED     [ 78%]
tests/test_nlu.py::TestPhoneticNormalization::test_tr_ch_swap PASSED     [ 78%]
tests/test_nlu.py::TestPhoneticNormalization::test_s_x_swap PASSED       [ 78%]
tests/test_nlu.py::TestPhoneticNormalization::test_gi_d_swap PASSED      [ 78%]
tests/test_nlu.py::TestPhoneticNormalization::test_no_variant_for_short_text PASSED [ 79%]
tests/test_nlu.py::TestPhoneticNormalization::test_empty_input PASSED    [ 79%]
tests/test_nlu.py::TestPhoneticNormalization::test_multi_word_variant PASSED [ 79%]
tests/test_normalize.py::test_normalize_query_preserves_accents PASSED   [ 79%]
tests/test_normalize.py::test_normalize_query_lowercases PASSED          [ 79%]
tests/test_normalize.py::test_normalize_query_strips_whitespace PASSED   [ 79%]
tests/test_normalize.py::test_normalize_strips_accents PASSED            [ 79%]
tests/test_normalize.py::test_normalize_handles_complex_accents PASSED   [ 79%]
tests/test_performance.py::test_embedding_cache_efficiency PASSED        [ 79%]
tests/test_performance.py::test_year_lookup_performance PASSED           [ 80%]
tests/test_performance.py::test_engine_deduplication PASSED              [ 80%]
tests/test_performance.py::test_query_normalization_caching PASSED       [ 80%]
tests/test_pipeline.py::test_extract_year[N\u0103m 1010, L\xfd Th\xe1i T\u1ed5 d\u1eddi \u0111\xf4.-1010] PASSED [ 80%]
tests/test_pipeline.py::test_extract_year[V\xe0o n\u0103m 1945, c\xe1ch m\u1ea1ng th\xe0nh c\xf4ng.-1945] PASSED [ 80%]
tests/test_pipeline.py::test_extract_year[Tr\u1eadn \u0111\xe1nh n\u0103m 938 tr\xean s\xf4ng B\u1ea1ch \u0110\u1eb1ng.-938] PASSED [ 80%]
tests/test_pipeline.py::test_person_not_place PASSED                     [ 80%]
tests/test_pipeline.py::test_place_not_person PASSED                     [ 80%]
tests/test_pipeline.py::test_country_not_person PASSED                   [ 80%]
tests/test_pipeline.py::test_dynasty_not_person[Nh\xe0 Tr\u1ea7n] PASSED [ 81%]
tests/test_pipeline.py::test_dynasty_not_person[Nh\xe0 L\xfd] PASSED     [ 81%]
tests/test_pipeline.py::test_dynasty_not_person[Tri\u1ec1u Nguy\u1ec5n] PASSED [ 81%]
tests/test_pipeline.py::test_dynasty_not_person[Qu\xe2n Thanh] PASSED    [ 81%]
tests/test_pipeline.py::test_dynasty_not_person[Qu\xe2n Minh] PASSED     [ 81%]
tests/test_pipeline.py::test_king_alias PASSED                           [ 81%]
tests/test_pipeline.py::test_royal_title_is_person PASSED                [ 81%]
tests/test_pipeline.py::test_classify_entity_place PASSED                [ 81%]
tests/test_pipeline.py::test_classify_entity_person PASSED               [ 81%]
tests/test_pipeline.py::test_infer_subject_person PASSED                 [ 82%]
tests/test_pipeline.py::test_infer_subject_collective PASSED             [ 82%]
tests/test_pipeline.py::test_infer_subject_document PASSED               [ 82%]
tests/test_pipeline.py::test_normalize_person_and_place PASSED           [ 82%]
tests/test_pipeline.py::test_normalize_rejects_vague PASSED              [ 82%]
tests/test_pipeline.py::test_classify_tone_heroic PASSED                 [ 82%]
tests/test_pipeline.py::test_classify_tone_somber PASSED                 [ 82%]
tests/test_pipeline.py::test_classify_nature_military PASSED             [ 82%]
tests/test_pipeline.py::test_classify_nature_institutional PASSED        [ 82%]
tests/test_pipeline.py::test_place_not_recognized_as_person[B\u1ea1ch \u0110\u1eb1ng] PASSED [ 83%]
tests/test_pipeline.py::test_place_not_recognized_as_person[Chi L\u0103ng] PASSED [ 83%]
tests/test_pipeline.py::test_place_not_recognized_as_person[\u0110\u1ed1ng \u0110a] PASSED [ 83%]
tests/test_pipeline.py::test_place_not_recognized_as_person[\u0110i\u1ec7n Bi\xean Ph\u1ee7] PASSED [ 83%]
tests/test_pipeline.py::test_no_false_persons[Nh\xe0 Tr\u1ea7n \u0111\xe1nh b\u1ea1i qu\xe2n Nguy\xean] PASSED [ 83%]
tests/test_pipeline.py::test_no_false_persons[Qu\xe2n Thanh ti\u1ebfn v\xe0o Th\u0103ng Long] PASSED [ 83%]
tests/test_schema_integrity.py::TestSchemaIntegrity::test_meta_json_exists PASSED [ 83%]
tests/test_schema_integrity.py::TestSchemaIntegrity::test_event_out_schema_compatibility PASSED [ 83%]
tests/test_schema_integrity.py::TestEndpoints::test_root_endpoint PASSED [ 83%]
tests/test_schema_integrity.py::TestEndpoints::test_health_detailed PASSED [ 84%]
tests/test_schema_integrity.py::TestEndpoints::test_chat_endpoint_mock PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_single_word PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_multi_word_phrase PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_remove_stop_words PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_empty_string PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_historical_phrase_bach_dang PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_historical_phrase_dien_bien_phu PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_combined_phrases_and_words PASSED [ 84%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_special_chars_removed PASSED [ 85%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_short_words_excluded PASSED [ 85%]
tests/test_search_utils.py::TestExtractImportantKeywords::test_phrase_independence PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_relevant_person_match PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_relevant_place_match PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_relevant_keyword_match PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_irrelevant_doc PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_dynasty_filter_match PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_dynasty_filter_partial_match PASSED [ 85%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_dynasty_filter_mismatch PASSED [ 86%]
tests/test_search_utils.py::TestCheckQueryRelevance::test_empty_keywords_accepts_all PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_empty_list PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_single_event PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_duplicate_events_merged PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_different_events_kept PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_max_events_limit PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_sorted_by_year PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_merged_persons_combined PASSED [ 86%]
tests/test_search_utils.py::TestDeduplicateAndEnrich::test_longer_story_preserved PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_persons_indexed PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_dynasty_indexed PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_keywords_indexed PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_places_indexed PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_empty_documents PASSED [ 87%]
tests/test_search_utils.py::TestBuildInvertedIndexes::test_index_points_to_correct_doc PASSED [ 87%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_load_real_knowledge_base PASSED [ 87%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_missing_file_no_crash PASSED [ 87%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_alias_maps_to_canonical PASSED [ 88%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_dynasty_alias_mapping PASSED [ 88%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_topic_synonym_mapping PASSED [ 88%]
tests/test_search_utils.py::TestLoadKnowledgeBase::test_invalid_json_no_crash PASSED [ 88%]
tests/test_search_utils.py::TestDetectDynastyWrapper::test_detect_nha_tran PASSED [ 88%]
tests/test_search_utils.py::TestDetectDynastyWrapper::test_detect_no_dynasty PASSED [ 88%]
tests/test_search_utils.py::TestDetectDynastyWrapper::test_detect_nha_ly PASSED [ 88%]
tests/test_search_utils.py::TestDetectDynastyWrapper::test_detect_place_wrapper PASSED [ 88%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_semicolon_summary_dien_ra PASSED [ 88%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_semicolon_summary_xay_ra PASSED [ 89%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_event_title_prefix PASSED [ 89%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_bare_title_year PASSED [ 89%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_ke_ve_prefix PASSED [ 89%]
tests/test_search_utils.py::TestPrefixStyleDedup::test_clean_tom_tat_prefix PASSED [ 89%]
tests/test_search_utils.py::TestMinTextLengthFilter::test_short_text_filtered PASSED [ 89%]
tests/test_search_utils.py::TestCrossYearDedup::test_same_event_different_year_groups PASSED [ 89%]
tests/test_search_utils.py::TestCrossYearDedup::test_distinct_events_not_merged PASSED [ 89%]
tests/test_search_utils.py::TestAdaptiveRelevance::test_long_query_rejects_weak_match PASSED [ 89%]
tests/test_search_utils.py::TestAdaptiveRelevance::test_short_query_accepts_single_match PASSED [ 90%]
tests/test_storyteller_unit.py::TestExtractYear::test_extract_year_simple PASSED [ 90%]
tests/test_storyteller_unit.py::TestExtractYear::test_extract_year_with_date PASSED [ 90%]
tests/test_storyteller_unit.py::TestExtractYear::test_extract_year_no_year PASSED [ 90%]
tests/test_storyteller_unit.py::TestExtractYear::test_extract_year_ancient PASSED [ 90%]
tests/test_storyteller_unit.py::TestClassifyTone::test_heroic_tone PASSED [ 90%]
tests/test_storyteller_unit.py::TestClassifyTone::test_somber_tone PASSED [ 90%]
tests/test_storyteller_unit.py::TestClassifyTone::test_neutral_tone PASSED [ 90%]
tests/test_storyteller_unit.py::TestClassifyTone::test_heroic_by_year PASSED [ 90%]
tests/test_storyteller_unit.py::TestIsValidPerson::test_valid_person PASSED [ 91%]
tests/test_storyteller_unit.py::TestIsValidPerson::test_invalid_short_name PASSED [ 91%]
tests/test_storyteller_unit.py::TestIsValidPerson::test_invalid_place PASSED [ 91%]
tests/test_storyteller_unit.py::TestIsValidPerson::test_invalid_collective PASSED [ 91%]
tests/test_storyteller_unit.py::TestCanonicalPerson::test_alias_mapping PASSED [ 91%]
tests/test_storyteller_unit.py::TestCanonicalPerson::test_title_stripping PASSED [ 91%]
tests/test_storyteller_unit.py::TestCanonicalPerson::test_direct_name PASSED [ 91%]
tests/test_storyteller_unit.py::TestClassifyNature::test_military_nature PASSED [ 91%]
tests/test_storyteller_unit.py::TestClassifyNature::test_institutional_nature PASSED [ 91%]
tests/test_storyteller_unit.py::TestClassifyNature::test_general_nature PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_empty_string PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_none_input PASSED  [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_year_prefix_nam PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_year_prefix_vao_nam PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_gan_moc_prefix PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_boi_canh_prefix PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_tom_tat_prefix PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_ke_ve_prefix PASSED [ 92%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_dien_ra_prefix PASSED [ 93%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_trailing_year_parenthesis PASSED [ 93%]
tests/test_text_cleaning.py::TestCleanStoryText::test_remove_trailing_dia_diem PASSED [ 93%]
tests/test_text_cleaning.py::TestCleanStoryText::test_preserve_meaningful_content PASSED [ 93%]
tests/test_text_cleaning.py::TestCleanStoryText::test_combined_prefix_removal PASSED [ 93%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_empty_events PASSED [ 93%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_single_event PASSED [ 93%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_no_duplicate_events PASSED [ 93%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_multiple_years_sorted PASSED [ 93%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_no_double_year_mention PASSED [ 94%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_answer_ends_with_punctuation PASSED [ 94%]
tests/test_text_cleaning.py::TestFormatCompleteAnswer::test_no_gan_moc_in_output PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_1288 PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_938 PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_40 PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_1945 PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_2025_boundary PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_below_40_returns_none PASSED [ 94%]
tests/test_year_extraction.py::TestExtractSingleYear::test_nam_above_2025_returns_none PASSED [ 95%]
tests/test_year_extraction.py::TestExtractSingleYear::test_no_year_returns_none PASSED [ 95%]
tests/test_year_extraction.py::TestExtractSingleYear::test_year_in_phrase PASSED [ 95%]
tests/test_year_extraction.py::TestExtractSingleYear::test_three_digit_year PASSED [ 95%]
tests/test_year_extraction.py::TestExtractSingleYear::test_four_digit_year PASSED [ 95%]
tests/test_year_extraction.py::TestExtractSingleYear::test_year_1009_ly_thai_to PASSED [ 95%]
tests/test_year_extraction.py::TestExtractYearRange::test_tu_nam_den_nam PASSED [ 95%]
tests/test_year_extraction.py::TestExtractYearRange::test_giai_doan PASSED [ 95%]
tests/test_year_extraction.py::TestExtractYearRange::test_tu_den_with_nam PASSED [ 95%]
tests/test_year_extraction.py::TestExtractYearRange::test_dash_separator PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_en_dash_separator PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_toi_separator PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_invalid_range_start_gt_end PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_out_of_scope_years PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_no_range_returns_none PASSED [ 96%]
tests/test_year_extraction.py::TestExtractYearRange::test_single_year_not_range PASSED [ 96%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_two_years_va PASSED [ 96%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_three_years PASSED [ 96%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_single_year_returns_none PASSED [ 97%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_range_query_returns_none PASSED [ 97%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_no_years_returns_none PASSED [ 97%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_duplicate_years_removed PASSED [ 97%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_sorted_output PASSED [ 97%]
tests/test_year_extraction.py::TestExtractMultipleYears::test_mixed_format PASSED [ 97%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_standard_format PASSED [ 97%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_short_format PASSED [ 97%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_dash_format PASSED [ 97%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_english_from_to PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_english_between PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_giai_doan PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_with_context PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_invalid_order PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeExtraction::test_extract_year_range_out_of_bounds PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_standard PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_all_events_included PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_short_format PASSED [ 98%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_dash_format PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_english PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_various_phrasings PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_answer_format PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_context7_not_too_strict PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeQuery::test_year_range_query_chronological_order PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeEdgeCases::test_year_range_single_year_span PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeEdgeCases::test_year_range_very_large_span PASSED [ 99%]
tests/test_year_range_query.py::TestYearRangeEdgeCases::test_year_range_no_events_in_range PASSED [100%]

============================== warnings summary ===============================
<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:241
  <frozen importlib._bootstrap>:241: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================= 896 passed, 3 skipped, 3 warnings in 21.11s =================
